<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>匿名函数和闭包 | 前端知识架构</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/web/favicon.ico">
    <meta name="description" content="一份耕耘，一份收获">
    <link rel="preload" href="/web/assets/css/0.styles.2154e1d6.css" as="style"><link rel="preload" href="/web/assets/js/app.8467f5ab.js" as="script"><link rel="preload" href="/web/assets/js/2.8d3b33bd.js" as="script"><link rel="preload" href="/web/assets/js/31.35764e69.js" as="script"><link rel="prefetch" href="/web/assets/js/10.7a01bfe0.js"><link rel="prefetch" href="/web/assets/js/11.9434c272.js"><link rel="prefetch" href="/web/assets/js/12.9e6f10b2.js"><link rel="prefetch" href="/web/assets/js/13.fe0ef855.js"><link rel="prefetch" href="/web/assets/js/14.302f4517.js"><link rel="prefetch" href="/web/assets/js/15.660f56d4.js"><link rel="prefetch" href="/web/assets/js/16.46fc2947.js"><link rel="prefetch" href="/web/assets/js/17.d3cd12e3.js"><link rel="prefetch" href="/web/assets/js/18.8494a138.js"><link rel="prefetch" href="/web/assets/js/19.3a3d2df5.js"><link rel="prefetch" href="/web/assets/js/20.f5a53c39.js"><link rel="prefetch" href="/web/assets/js/21.030b82b6.js"><link rel="prefetch" href="/web/assets/js/22.d8388d13.js"><link rel="prefetch" href="/web/assets/js/23.fbc73fa5.js"><link rel="prefetch" href="/web/assets/js/24.e744a1f2.js"><link rel="prefetch" href="/web/assets/js/25.42103518.js"><link rel="prefetch" href="/web/assets/js/26.f7f69a1c.js"><link rel="prefetch" href="/web/assets/js/27.e99a3e44.js"><link rel="prefetch" href="/web/assets/js/28.909292b8.js"><link rel="prefetch" href="/web/assets/js/29.ad2475de.js"><link rel="prefetch" href="/web/assets/js/3.ccafea9f.js"><link rel="prefetch" href="/web/assets/js/30.d8597d9b.js"><link rel="prefetch" href="/web/assets/js/32.bded8736.js"><link rel="prefetch" href="/web/assets/js/33.ed94c720.js"><link rel="prefetch" href="/web/assets/js/34.73a7c58c.js"><link rel="prefetch" href="/web/assets/js/35.513744f0.js"><link rel="prefetch" href="/web/assets/js/36.54a10e5d.js"><link rel="prefetch" href="/web/assets/js/37.0b875606.js"><link rel="prefetch" href="/web/assets/js/38.d1fd942d.js"><link rel="prefetch" href="/web/assets/js/39.391eb545.js"><link rel="prefetch" href="/web/assets/js/4.b7e6892f.js"><link rel="prefetch" href="/web/assets/js/40.6b58055b.js"><link rel="prefetch" href="/web/assets/js/41.18a47a08.js"><link rel="prefetch" href="/web/assets/js/42.bdc55719.js"><link rel="prefetch" href="/web/assets/js/43.ceab86cf.js"><link rel="prefetch" href="/web/assets/js/44.3f570633.js"><link rel="prefetch" href="/web/assets/js/45.cf947904.js"><link rel="prefetch" href="/web/assets/js/46.d54563a9.js"><link rel="prefetch" href="/web/assets/js/47.295b8176.js"><link rel="prefetch" href="/web/assets/js/48.dcecab73.js"><link rel="prefetch" href="/web/assets/js/49.30ed491b.js"><link rel="prefetch" href="/web/assets/js/5.98ae611d.js"><link rel="prefetch" href="/web/assets/js/6.a45f1e7c.js"><link rel="prefetch" href="/web/assets/js/7.749a3a54.js"><link rel="prefetch" href="/web/assets/js/8.17709c3b.js"><link rel="prefetch" href="/web/assets/js/9.69409426.js">
    <link rel="stylesheet" href="/web/assets/css/0.styles.2154e1d6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web/" class="home-link router-link-active"><!----> <span class="site-name">前端知识架构</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/web/basic/JavaScript/" class="nav-link router-link-active">
  基础知识
</a></div><div class="nav-item"><a href="/web/browser/" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/web/net/" class="nav-link">
  网络
</a></div><div class="nav-item"><a href="/web/performance/" class="nav-link">
  性能优化
</a></div><div class="nav-item"><a href="/web/vue/" class="nav-link">
  Vue
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/web/basic/JavaScript/" class="nav-link router-link-active">
  基础知识
</a></div><div class="nav-item"><a href="/web/browser/" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/web/net/" class="nav-link">
  网络
</a></div><div class="nav-item"><a href="/web/performance/" class="nav-link">
  性能优化
</a></div><div class="nav-item"><a href="/web/vue/" class="nav-link">
  Vue
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/web/basic/JavaScript/" class="sidebar-heading clickable router-link-active open"><span>JavaScript</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/basic/JavaScript/type.html" class="sidebar-link">类型</a></li><li><a href="/web/basic/JavaScript/function.html" class="sidebar-link">函数</a></li><li><a href="/web/basic/JavaScript/object.html" class="sidebar-link">面向对象</a></li><li><a href="/web/basic/JavaScript/nonfunctions-closures.html" class="active sidebar-link">匿名函数与闭包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web/basic/JavaScript/nonfunctions-closures.html#匿名函数" class="sidebar-link">匿名函数</a></li><li class="sidebar-sub-header"><a href="/web/basic/JavaScript/nonfunctions-closures.html#闭包" class="sidebar-link">闭包</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web/basic/JavaScript/nonfunctions-closures.html#闭包的相关知识点" class="sidebar-link">闭包的相关知识点</a></li><li class="sidebar-sub-header"><a href="/web/basic/JavaScript/nonfunctions-closures.html#闭包中的this问题" class="sidebar-link">闭包中的this问题</a></li><li class="sidebar-sub-header"><a href="/web/basic/JavaScript/nonfunctions-closures.html#模仿块级作用域" class="sidebar-link">模仿块级作用域</a></li></ul></li></ul></li><li><a href="/web/basic/JavaScript/this.html" class="sidebar-link">this指向</a></li><li><a href="/web/basic/JavaScript/json.html" class="sidebar-link">JSON</a></li><li><a href="/web/basic/JavaScript/RegExp.html" class="sidebar-link">正则表达式RegExp</a></li><li><a href="/web/basic/JavaScript/cookie.html" class="sidebar-link">cookie</a></li><li><a href="/web/basic/JavaScript/Date.html" class="sidebar-link">Date</a></li><li><a href="/web/basic/JavaScript/shallow-copy.html" class="sidebar-link">浅复制</a></li><li><a href="/web/basic/JavaScript/deep-copy.html" class="sidebar-link">深复制</a></li><li><a href="/web/basic/JavaScript/ajax.html" class="sidebar-link">Ajax</a></li><li><a href="/web/basic/JavaScript/error.html" class="sidebar-link">错误处理</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/web/basic/CSS/" class="sidebar-heading clickable"><span>CSS</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/web/basic/HTML/" class="sidebar-heading clickable"><span>HTML</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="匿名函数和闭包"><a href="#匿名函数和闭包" class="header-anchor">#</a> 匿名函数和闭包</h1> <h2 id="匿名函数"><a href="#匿名函数" class="header-anchor">#</a> 匿名函数</h2> <blockquote><p>没有函数名字的函数</p></blockquote> <ul><li>单独的匿名函数是无法运行和调用的</li> <li>可以把匿名函数赋值给变量</li> <li>通过表达式自我执行，语法：(匿名函数)()</li> <li>匿名函数传递参数，语法：(匿名函数)(参数)</li></ul> <div class="language-{.javaScript} line-numbers-mode"><pre class="language-text"><code>// 情况1.把匿名函数赋值给变量  
var fn=function (){
    alert('我是匿名函数')
}
alert(fn)   //会将函数表达式输出
fn()  

//情况2.匿名函数通过表达式自我执行
(function (){
    alert('我是匿名函数')
}
)()

//匿名函数传递参数
function myfn(m,n){
    alert(m+n)
}
myfn(100,100);

(function(m,n){
    alert(m+n)
})(1000,1000)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="闭包"><a href="#闭包" class="header-anchor">#</a> 闭包</h2> <blockquote><p>闭包的英文单词是closure，是指有权访问另一个函数作用域中变量的函数。<br>
在本质上，闭包就是将函数内部和函数外部连接起来的一座桥梁。内层的函数可以使用外层函数的所有变量，即使外层函数已经执行完毕。</p></blockquote> <div class="language-{.javaScript} line-numbers-mode"><pre class="language-text"><code>function myfn(){
    return function (){
        return('**********')
    }
}
//alert(myfn)  //输出整个函数表达式
//alert(myfn())  //输出匿名函数表达式

//调用方式1
alert(myfn()())
//调用方式2
var bb=myfn()
alert(bb())
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="闭包的相关知识点"><a href="#闭包的相关知识点" class="header-anchor">#</a> 闭包的相关知识点</h3> <ul><li>常见的方式是在函数内部创建另一个函数</li> <li>闭包的第一个用途：通过闭包可以访问局部变量</li></ul> <div class="language-{.javaScript} line-numbers-mode"><pre class="language-text"><code>function myfn(){
    var bb='局部变量bb'
    return function (){
        return(bb) // 通过匿名函数返回myfn()的局部变量bb;
    }
}
//调用方式1
//alert(myfn()())

//调用方式2
var csbb=myfn()
alert(csbb())
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>闭包的第二个用途：可以让局部变量的值始终保持在内存中<br>
  优点:可以把局部变量驻留在内存中,可以避免使用全局变量;[全局变量在复杂程序中会造成许多麻烦（比如命名冲突，垃圾回收等），所以推荐使用私有的,封装的局部变量。而闭包可以实现这一点。]<br>
  缺点：由于闭包里作用域返回的局部变量资源不会被立刻销毁回收,所以可能会占用更多的内存;所以过度使用闭包会导致性能下降</li></ul> <div class="language-{.javaScript} line-numbers-mode"><pre class="language-text"><code>function add(){
    var num= 100; // 这里改为局部变量;
    return function(){
        num++;
        alert(num);
    }
};
// add()();add()();add()();//这种调用方式会出错,因为每次调用 num都会初始化一次;  
var fn=add()//只在这里初始化一次，后边调用的时候执行的是里边的匿名函数
fn();fn();fn();
fn=null //应及时解除引用，否则会占用更多内存
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-{.javaScript} line-numbers-mode"><pre class="language-text"><code>function fun(){
    var arr=[];
    for(var i=0; i&lt;5; i++){
        arr[i]=function(n){  
            return function(){  
                return '元素'+n;
            }
        }(i)  
    }
    return arr
}
var Bb=fun()
//alert(Bb.length)
// alert(Bb[0]())
for(var i=0; i&lt;5; i++){
    //alert(Bb[i])  
    alert(Bb[i]())  
}
//这次成功的输出了 ‘元素0 元素1 元素2 元素3 元素4 ’，而不再都是[元素5]
/*
    1.这里的匿名函数有一个参数 n，也就是最终将返回的结果数值；
    2.在调用每个匿名函数时传入变量i
    3.变量i的当前值会赋值给n，
    4.匿名函数内部创建并返回了一个访问n的闭包
    5.如此数组arr中的每个函数中都有了自己的n变量的一个副本(闭包可以将局部变量贮存在内存中)

*/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="闭包中的this问题"><a href="#闭包中的this问题" class="header-anchor">#</a> 闭包中的this问题</h3> <ul><li>this是在运行时基于函数的执行环境来绑定的</li> <li>全局函数中的this是window，而当函数作为某个对象的方法调用时，this就是指的那个对象</li> <li>匿名函数的执行环境具有全局性，this通常是指向window的</li></ul> <div class="language-{.javaScript} line-numbers-mode"><pre class="language-text"><code>var name='The Window';
var obj={
    name:'my obj',
    get:function(){
        return function(){
            return this.name;
        }
    }
}

alert(obj.get()()) //这次返回的是全局变量 'The Window'
alert(obj.get().call(obj))//这次又返回的是'my obj'，因为call()强制改变了this的指向


var name='The Window';
var obj={
    name:'my obj',
    get:function(){
        //这里的this指的是对象，这里为obj
        var self=this
        return function(){
            //闭包里的this指的是window
            return self.name;
        }
    }
}
alert(obj.get()())  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="模仿块级作用域"><a href="#模仿块级作用域" class="header-anchor">#</a> 模仿块级作用域</h3> <div class="language-{.javaScript} line-numbers-mode"><pre class="language-text"><code>function myfun() {
    for(var i=0;i&lt;5;i++){

    }  //i不会因为离开了for块就失效;
    var i; //重新声明后i还是5,
    alert(i)  //此时的i=5
}

//模仿块级作用域
function myfun() {
    (function(){
      for(var i=0;i&lt;5;i++){
          alert(i)  
      }  
    })()  // 这里定义并立即调用了一个匿名函数;  
    alert(i)  
    //此时的i已结不存在 会报错:'i is not defined'
}
myfun()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/29/2020, 6:37:52 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web/basic/JavaScript/object.html" class="prev">
        面向对象
      </a></span> <span class="next"><a href="/web/basic/JavaScript/this.html">
        this指向
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/web/assets/js/app.8467f5ab.js" defer></script><script src="/web/assets/js/2.8d3b33bd.js" defer></script><script src="/web/assets/js/31.35764e69.js" defer></script>
  </body>
</html>
