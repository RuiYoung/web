<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>webpack 性能调优与 Gzip 原理(如何从webpack着手性能优化) | 前端知识架构</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/web/favicon.ico">
    <meta name="description" content="一份耕耘，一份收获">
    <link rel="preload" href="/web/assets/css/0.styles.2154e1d6.css" as="style"><link rel="preload" href="/web/assets/js/app.8467f5ab.js" as="script"><link rel="preload" href="/web/assets/js/2.8d3b33bd.js" as="script"><link rel="preload" href="/web/assets/js/48.dcecab73.js" as="script"><link rel="prefetch" href="/web/assets/js/10.7a01bfe0.js"><link rel="prefetch" href="/web/assets/js/11.9434c272.js"><link rel="prefetch" href="/web/assets/js/12.9e6f10b2.js"><link rel="prefetch" href="/web/assets/js/13.fe0ef855.js"><link rel="prefetch" href="/web/assets/js/14.302f4517.js"><link rel="prefetch" href="/web/assets/js/15.660f56d4.js"><link rel="prefetch" href="/web/assets/js/16.46fc2947.js"><link rel="prefetch" href="/web/assets/js/17.d3cd12e3.js"><link rel="prefetch" href="/web/assets/js/18.8494a138.js"><link rel="prefetch" href="/web/assets/js/19.3a3d2df5.js"><link rel="prefetch" href="/web/assets/js/20.f5a53c39.js"><link rel="prefetch" href="/web/assets/js/21.030b82b6.js"><link rel="prefetch" href="/web/assets/js/22.d8388d13.js"><link rel="prefetch" href="/web/assets/js/23.fbc73fa5.js"><link rel="prefetch" href="/web/assets/js/24.e744a1f2.js"><link rel="prefetch" href="/web/assets/js/25.42103518.js"><link rel="prefetch" href="/web/assets/js/26.f7f69a1c.js"><link rel="prefetch" href="/web/assets/js/27.e99a3e44.js"><link rel="prefetch" href="/web/assets/js/28.909292b8.js"><link rel="prefetch" href="/web/assets/js/29.ad2475de.js"><link rel="prefetch" href="/web/assets/js/3.ccafea9f.js"><link rel="prefetch" href="/web/assets/js/30.d8597d9b.js"><link rel="prefetch" href="/web/assets/js/31.35764e69.js"><link rel="prefetch" href="/web/assets/js/32.bded8736.js"><link rel="prefetch" href="/web/assets/js/33.ed94c720.js"><link rel="prefetch" href="/web/assets/js/34.73a7c58c.js"><link rel="prefetch" href="/web/assets/js/35.513744f0.js"><link rel="prefetch" href="/web/assets/js/36.54a10e5d.js"><link rel="prefetch" href="/web/assets/js/37.0b875606.js"><link rel="prefetch" href="/web/assets/js/38.d1fd942d.js"><link rel="prefetch" href="/web/assets/js/39.391eb545.js"><link rel="prefetch" href="/web/assets/js/4.b7e6892f.js"><link rel="prefetch" href="/web/assets/js/40.6b58055b.js"><link rel="prefetch" href="/web/assets/js/41.18a47a08.js"><link rel="prefetch" href="/web/assets/js/42.bdc55719.js"><link rel="prefetch" href="/web/assets/js/43.ceab86cf.js"><link rel="prefetch" href="/web/assets/js/44.3f570633.js"><link rel="prefetch" href="/web/assets/js/45.cf947904.js"><link rel="prefetch" href="/web/assets/js/46.d54563a9.js"><link rel="prefetch" href="/web/assets/js/47.295b8176.js"><link rel="prefetch" href="/web/assets/js/49.30ed491b.js"><link rel="prefetch" href="/web/assets/js/5.98ae611d.js"><link rel="prefetch" href="/web/assets/js/6.a45f1e7c.js"><link rel="prefetch" href="/web/assets/js/7.749a3a54.js"><link rel="prefetch" href="/web/assets/js/8.17709c3b.js"><link rel="prefetch" href="/web/assets/js/9.69409426.js">
    <link rel="stylesheet" href="/web/assets/css/0.styles.2154e1d6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web/" class="home-link router-link-active"><!----> <span class="site-name">前端知识架构</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/web/basic/JavaScript/" class="nav-link">
  基础知识
</a></div><div class="nav-item"><a href="/web/browser/" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/web/net/" class="nav-link">
  网络
</a></div><div class="nav-item"><a href="/web/performance/" class="nav-link router-link-active">
  性能优化
</a></div><div class="nav-item"><a href="/web/vue/" class="nav-link">
  Vue
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/web/basic/JavaScript/" class="nav-link">
  基础知识
</a></div><div class="nav-item"><a href="/web/browser/" class="nav-link">
  浏览器
</a></div><div class="nav-item"><a href="/web/net/" class="nav-link">
  网络
</a></div><div class="nav-item"><a href="/web/performance/" class="nav-link router-link-active">
  性能优化
</a></div><div class="nav-item"><a href="/web/vue/" class="nav-link">
  Vue
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/web/performance/" class="sidebar-heading clickable router-link-active open"><span>前端性能优化</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/web/performance/browser-optimize.html" class="sidebar-link">解锁浏览器背后的运行机制</a></li><li><a href="/web/performance/cdn-optimize.html" class="sidebar-link">CDN 的缓存与回源机制解析</a></li><li><a href="/web/performance/dom-optimize.html" class="sidebar-link">DOM 优化原理与基本实践</a></li><li><a href="/web/performance/event-loop-optimize.html" class="sidebar-link">Event Loop 与异步更新策略</a></li><li><a href="/web/performance/picture-optimize.html" class="sidebar-link">图片优化——质量与性能的博弈</a></li><li><a href="/web/performance/process.html" class="sidebar-link">浏览器加载流程</a></li><li><a href="/web/performance/ssr-optimize.html" class="sidebar-link">服务端渲染的探索与实践</a></li><li><a href="/web/performance/storage-optimize.html" class="sidebar-link">本地存储——从 Cookie 到 Web Storage、IndexedD</a></li><li><a href="/web/performance/webpack-optimize.html" class="active sidebar-link">webpack 性能调优与 Gzip 原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web/performance/webpack-optimize.html#http-优化有两个大的方向：" class="sidebar-link">HTTP 优化有两个大的方向：</a></li><li class="sidebar-sub-header"><a href="/web/performance/webpack-optimize.html#webpack-的优化瓶颈，主要是两个方面：" class="sidebar-link">webpack 的优化瓶颈，主要是两个方面：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web/performance/webpack-optimize.html#webpack-优化方案" class="sidebar-link">webpack 优化方案</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="webpack-性能调优与-gzip-原理-如何从webpack着手性能优化"><a href="#webpack-性能调优与-gzip-原理-如何从webpack着手性能优化" class="header-anchor">#</a> webpack 性能调优与 Gzip 原理(如何从webpack着手性能优化)</h1> <blockquote><p>对于 DNS 解析和 TCP 连接两个步骤，我们前端可以做的努力非常有限。相比之下，HTTP 连接这一层面的优化才是我们网络优化的核心。</p></blockquote> <h2 id="http-优化有两个大的方向："><a href="#http-优化有两个大的方向：" class="header-anchor">#</a> HTTP 优化有两个大的方向：</h2> <ul><li>减少请求次数</li> <li>减少单次请求所花费的时间</li></ul> <h2 id="webpack-的优化瓶颈，主要是两个方面："><a href="#webpack-的优化瓶颈，主要是两个方面：" class="header-anchor">#</a> webpack 的优化瓶颈，主要是两个方面：</h2> <ul><li>webpack 的构建过程太花时间</li> <li>webpack 打包的结果体积太大</li></ul> <h3 id="webpack-优化方案"><a href="#webpack-优化方案" class="header-anchor">#</a> webpack 优化方案</h3> <h4 id="不要让-loader-做太多事情"><a href="#不要让-loader-做太多事情" class="header-anchor">#</a> 不要让 loader 做太多事情</h4> <p>最常见的优化方式是，用 include 或 exclude 来帮我们避免不必要的转译</p> <div class="language-javaScript line-numbers-mode"><pre class="language-javascript"><code>module<span class="token operator">:</span> <span class="token punctuation">{</span>
  rules<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      test<span class="token operator">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
      exclude<span class="token operator">:</span> <span class="token regex">/(node_modules|bower_components)/</span><span class="token punctuation">,</span>
      use<span class="token operator">:</span> <span class="token punctuation">{</span>
        loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
        options<span class="token operator">:</span> <span class="token punctuation">{</span>
          presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>通过限定文件范围带来的性能提升是有限的。除此之外，如果我们选择开启缓存将转译结果缓存至文件系统，则至少可以将 babel-loader 的工作效率提升两倍</p> <div class="language-{.javaScript} line-numbers-mode"><pre class="language-text"><code>loader: 'babel-loader?cacheDirectory=true'
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>不要放过第三方库(第三方库以 node_modules 为代表，它们庞大得可怕，却又不可或缺。)</p> <h4 id="dllplugin-是基于-windows-动态链接库（dll）的思想被创作出来的。这个插件会把第三方库单独打包到一个文件中，这个文件就是一个单纯的依赖库。这个依赖库不会跟着你的业务代码一起被重新打包，只有当依赖自身发生版本变化时才会重新打包。"><a href="#dllplugin-是基于-windows-动态链接库（dll）的思想被创作出来的。这个插件会把第三方库单独打包到一个文件中，这个文件就是一个单纯的依赖库。这个依赖库不会跟着你的业务代码一起被重新打包，只有当依赖自身发生版本变化时才会重新打包。" class="header-anchor">#</a> DllPlugin 是基于 Windows 动态链接库（dll）的思想被创作出来的。这个插件会把第三方库单独打包到一个文件中，这个文件就是一个单纯的依赖库。这个依赖库不会跟着你的业务代码一起被重新打包，只有当依赖自身发生版本变化时才会重新打包。</h4> <p>用 DllPlugin 处理文件，要分两步走：
1.基于 dll 专属的配置文件，打包 dll 库
2.基于 webpack.config.js 文件，打包业务代码</p> <h4 id="happypack-将-loader-由单进程转为多进程"><a href="#happypack-将-loader-由单进程转为多进程" class="header-anchor">#</a> Happypack——将 loader 由单进程转为多进程</h4> <p>大家知道，webpack 是单线程的，就算此刻存在多个任务，你也只能排队一个接一个地等待处理。这是 webpack 的缺点，好在我们的 CPU 是多核的，Happypack 会充分释放 CPU 在多核并发方面的优势，帮我们把任务分解给多个子进程去并发执行，大大提升打包效率。</p> <h4 id="删除冗余代码"><a href="#删除冗余代码" class="header-anchor">#</a> 删除冗余代码</h4> <p>一个比较典型的应用，就是 Tree-Shaking。
基于 import/export 语法，Tree-Shaking 可以在编译的过程中获悉哪些模块并没有真正被使用，这些没用的代码，在最后打包的时候会被去除。</p> <h4 id="按需加载"><a href="#按需加载" class="header-anchor">#</a> 按需加载</h4> <p>一次不加载完所有的文件内容，只加载此刻需要用到的那部分（会提前做拆分）
当需要更多内容时，再对用到的内容进行即时加载</p> <h4 id="gzip-压缩"><a href="#gzip-压缩" class="header-anchor">#</a> Gzip 压缩</h4> <p>HTTP 压缩是一种内置到网页服务器和网页客户端中以改进传输速度和带宽利用率的方式。在使用 HTTP 压缩的情况下，HTTP 数据在从服务器发送前就已压缩：兼容的浏览器将在下载所需的格式前宣告支持何种方法给服务器；不支持压缩方法的浏览器将下载未经压缩的数据。最常见的压缩方案包括 Gzip 和 Deflate。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/29/2020, 6:37:52 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web/performance/storage-optimize.html" class="prev">
        本地存储——从 Cookie 到 Web Storage、IndexedD
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/web/assets/js/app.8467f5ab.js" defer></script><script src="/web/assets/js/2.8d3b33bd.js" defer></script><script src="/web/assets/js/48.dcecab73.js" defer></script>
  </body>
</html>
